% ******************************************************************************
% ****************************** Custom Margin *********************************

% Add `custommargin' in the document class options to use this section
% Set {innerside margin / outerside margin / topmargin / bottom margin}  and
% other page dimensions
\ifsetCustomMargin
  \RequirePackage[left=25mm,right=25mm,top=25mm,bottom=25mm]{geometry}
  \setFancyHdr % To apply fancy header after geometry package is loaded
\fi

% Add spaces between paragraphs
\setlength{\parskip}{0.5em}
%Set indentation length for paragraphs
\setlength{\parindent}{0pt}
% Ragged bottom avoids extra whitespaces between paragraphs
\raggedbottom
% To remove the excess top spacing for enumeration, list and description
%\usepackage{enumitem}
%\setlist[enumerate,itemize,description]{topsep=0em}

% *****************************************************************************
% ******************* Fonts (like different typewriter fonts etc.)*************

% Add `customfont' in the document class option to use this section

\usepackage{sectsty} % for sf sections

\ifsetCustomFont
\usepackage[footnotefigures]{MinionPro}
\usepackage[footnotefigures]{MyriadPro}
\input{glyphtounicode}
\pdfgentounicode=1
\renewcommand{\scdefault}{ssc}
\allsectionsfont{\sffamily}


%\usepackage[scaled=0.85]{luximono} % Monospace font
%\usepackage[letterspace=160,babel=true,tracking=true,kerning=true]{microtype}

  % Set your custom font here and use `customfont' in options. Leave empty to
  % load computer modern font (default LaTeX font).
  %\RequirePackage{helvet}

  % For use with XeLaTeX
  %  \setmainfont[
  %    Path              = ./libertine/opentype/,
  %    Extension         = .otf,
  %    UprightFont = LinLibertine_R,
  %    BoldFont = LinLibertine_RZ, % Linux Libertine O Regular Semibold
  %    ItalicFont = LinLibertine_RI,
  %    BoldItalicFont = LinLibertine_RZI, % Linux Libertine O Regular Semibold Italic
  %  ]
  %  {libertine}
  %  % load font from system font
  %  \newfontfamily\libertinesystemfont{Linux Libertine O}
\fi

% *****************************************************************************
% **************************** Custom Packages ********************************

% ************************* Algorithms and Pseudocode **************************

%\usepackage{algpseudocode}


% ********************Captions and Hyperreferencing / URL **********************

% Captions: This makes captions of figures use a boldfaced small font.
%\RequirePackage[small,bf]{caption}

\RequirePackage[small,tableposition=top,labelfont=bf]{caption}
%\renewcommand{\figurename}{Figure~} %to support older versions of captions.sty
%\renewcommand{\tablename}{Table~}

% *************************** Graphics and figures *****************************

%\usepackage{rotating}
%\usepackage{wrapfig}

% Uncomment the following two lines to force Latex to place the figure.
% Use [H] when including graphics. Note 'H' instead of 'h'
%\usepackage{float}
%\restylefloat{figure}
\renewcommand{\topfraction}{.75}
% Subcaption package is also available in the sty folder you can use that by
% uncommenting the following line
% This is for people stuck with older versions of texlive
%\usepackage{sty/caption/subcaption}
\usepackage[labelformat=simple]{subcaption}
\renewcommand\thesubfigure{(\alph{subfigure})}
%
%\DeclareSubrefFormat{myparens}{#1~(#2)}
%\captionsetup[subfloat]{subrefformat=myparens}

% ********************************** Tables ************************************
\usepackage{booktabs} % For professional looking tables
\usepackage{multirow}

\usepackage{multicol}
%\usepackage{longtable}
%\usepackage{tabularx}
\usepackage{etoolbox}
\AtBeginEnvironment{tabular}{\small}


% *********************************** SI Units *********************************
\usepackage[binary-units=true]{siunitx} % use this package module for SI units


% ******************************* Line Spacing *********************************

% Choose linespacing as appropriate. Default is one-half line spacing as per the
% University guidelines

% \doublespacing
% \onehalfspacing
\singlespacing
\frenchspacing

% ******************************* Language *********************************
\usepackage[ngerman,british]{babel}

% ******************************** Hyphenations**********************************
\hyphenchar\font=\string"7F
%\hyphenation{Trans-zen-denz trans-zen-dent}

\begin{hyphenrules}{ngerman}
	\hyphenation{Arbeits-at-mo-sphÃ¤-re}
\end{hyphenrules}

% ************************ Formatting / Footnote *******************************

% Don't break enumeration (etc.) across pages in an ugly manner (default 10000)
%\clubpenalty=500
%\widowpenalty=500
\usepackage{footnotebackref}
\usepackage[perpage,hang,symbol]{footmisc} %Range of footnote options
%\renewcommand*{\thefootnote}{(\arabic{footnote})}
\DefineFNsymbols*{lamportnostar}[math]{\dagger\S\ddagger\P\|{\dagger\dagger}{\ddagger\ddagger}}
\setfnsymbol{lamportnostar}
% *****************************************************************************
% *************************** Bibliography  and References ********************

\usepackage{cleveref} %Referencing without need to explicitly state fig /table

% Add `custombib' in the document class option to use this section
\ifuseCustomBib
   \RequirePackage[square, sort, numbers, authoryear]{natbib} % CustomBib

% If you would like to use biblatex for your reference management, as opposed to the default `natbibpackage` pass the option `custombib` in the document class. Comment out the previous line to make sure you don't load the natbib package. Uncomment the following lines and specify the location of references.bib file

%\RequirePackage[backend=biber, style=numeric, citestyle=numeric, natbib=true, sorting=none]{biblatex}
%%\addbibresource{References/dummy.bib}
%\addbibresource{References/references.bib}
%\addbibresource{References/atlas_journal.bib}
%\addbibresource{References/atlas_pub.bib}
%\addbibresource{References/atlas_conf.bib}
%\addbibresource{References/websites.bib} %Location of references.bib only for biblatex, Do not omit the .bib extension from the filename.

\fi

% changes the default name `Bibliography` -> `References'
\renewcommand{\bibname}{References}


% ******************************************************************************
% ************************* User Defined Commands ******************************
% ******************************************************************************

% *********** To change the name of Table of Contents / LOF and LOT ************

%\renewcommand{\contentsname}{My Table of Contents}
%\renewcommand{\listfigurename}{My List of Figures}
%\renewcommand{\listtablename}{My List of Tables}


% ********************** TOC depth and numbering depth *************************

\setcounter{secnumdepth}{2}
\setcounter{tocdepth}{2}

\usepackage[titles]{tocloft}
\setlength{\cftbeforechapskip}{2pt}
\setlength{\cftbeforesecskip}{-4pt}
\setlength{\cftbeforesubsecskip}{-4pt}
%\setlength\cftparskip{-2pt}

% ******************************* Nomenclature *********************************
% To change the name of the Nomenclature section, uncomment the following line
\renewcommand{\nomname}{Symbols}

\RequirePackage[acronym]{glossaries}
\renewcommand*{\glstextformat}[1]{\textcolor{black}{#1}}
\makeglossaries

% ********************************* Appendix ***********************************

% The default value of both \appendixtocname and \appendixpagename is `Appendices'. These names can all be changed via:

%\renewcommand{\appendixtocname}{List of appendices}
%\renewcommand{\appendixname}{Appndx}

% *********************** Configure Draft Mode **********************************

% Uncomment to disable figures in `draft'
%\setkeys{Gin}{draft=true}  % set draft to false to enable figures in `draft'

% These options are active only during the draft mode
% Default text is "Draft"
%\SetDraftText{DRAFT}

% Default Watermark location is top. Location (top/bottom)
%\SetDraftWMPosition{bottom}

% Draft Version - default is v1.0
%\SetDraftVersion{v1.1}

% Draft Text grayscale value (should be between 0-black and 1-white)
% Default value is 0.75
%\SetDraftGrayScale{0.8}


% ******************************** Todo Notes **********************************
%% Uncomment the following lines to have todonotes.

%\ifsetDraft
%	\usepackage[colorinlistoftodos]{todonotes}
%	\newcommand{\mynote}[1]{\todo[author=kks32,size=\small,inline,color=green!40]{#1}}
%\else
%	\newcommand{\mynote}[1]{}
%	\newcommand{\listoftodos}{}
%\fi

% Example todo: \mynote{Hey! I have a note}

% ******************************** Listings **********************************

\usepackage{listings}
\usepackage{xcolor}
\crefname{lstlisting}{listing}{listings}
\Crefname{lstlisting}{Listing}{Listings}

\colorlet{punct}{black}
\definecolor{delim}{HTML}{000000}
\definecolor{kw_color}{HTML}{0b0273}
\definecolor{string_color}{HTML}{5184ad}
\definecolor{bool_color}{HTML}{2a7d18}
\colorlet{numb}{magenta!60!black}

\lstset{aboveskip=10pt,belowskip=5pt}
\lstdefinelanguage{json}{
    basicstyle=\scriptsize\ttfamily,
    keywords={true,false,null},
    keywordstyle=\color{bool_color}\bfseries,
    commentstyle=\color{string_color}\bfseries, % Green strings
    stringstyle=\color{kw_color}\bfseries, % Purple keywords
    numberstyle=\scriptsize,
    stepnumber=1,
    numbersep=8pt,
    showstringspaces=false,
    breaklines=true,
    frame=lines,
%    backgroundcolor=\color{background},
    comment=[s]{\ "}{"},
    string=[s]{"}{"},
    literate=
     *{0}{{{\color{numb}0}}}{1}
      {1}{{{\color{numb}1}}}{1}
      {2}{{{\color{numb}2}}}{1}
      {3}{{{\color{numb}3}}}{1}
      {4}{{{\color{numb}4}}}{1}
      {5}{{{\color{numb}5}}}{1}
      {6}{{{\color{numb}6}}}{1}
      {7}{{{\color{numb}7}}}{1}
      {8}{{{\color{numb}8}}}{1}
      {9}{{{\color{numb}9}}}{1}
      {:}{{{\color{punct}{:}}}}{1}
      {,}{{{\color{punct}{,}}}}{1}
      {\{}{{{\color{delim}{\{}}}}{1}
      {\}}{{{\color{delim}{\}}}}}{1}
      {[}{{{\color{delim}{[}}}}{1}
      {]}{{{\color{delim}{]}}}}{1},
}




\usepackage{enumitem} % better enumeration
\usepackage{relsize} % for Cpp command
\usepackage{placeins}
\usepackage{braket}
\usepackage{bbold}
\usepackage{multirow}
\usepackage{tikz}
\usepackage{pdflscape}
\usepackage{xargs}    % Use more than one optional parameter in a new commands       
\usepackage{makecell}
\usepackage{rotating} % for landscape figures


% package for displaying captions on weird places
\RequirePackage{floatrow}
\floatsetup[table]{capposition=above}

% Select what to do with todonotes: 
% \usepackage[disable]{todonotes} % notes not showed
\setlength{\marginparwidth}{2cm}
\usepackage[draft,textsize=small,disable]{todonotes}   % notes showed

% ******************************** Style stuff **********************************
% ************************* Some hacks of my thesis style class I am too lazy to implement correctly ****************************
%
%\usepackage{titlesec}
%\titleformat{\chapter}[display]
%	{\normalfont\LARGE}
%	{\filleft\MakeUppercase{\chaptertitlename}\hspace{0.5cm}\rlap{\resizebox{!}{1.5cm}{\thechapter}~\rule{5cm}{1.5cm}}\hspace{0.0cm}}
%  	{10pt}
%  	{\bf\LARGE\filright}
%\titlespacing*{\chapter}{0pt}{30pt}{20pt}

%\newcommand*\HUGE{\Huge}
%\newcommand*\chapnamefont{\normalfont\LARGE\MakeUppercase}
%\newcommand*\chapnumfont{\normalfont\HUGE}
%\newcommand*\chaptitlefont{\normalfont\HUGE\bfseries}
%
%\newlength\beforechapskip
%\newlength\midchapskip
%\setlength\midchapskip{\paperwidth}
%\addtolength\midchapskip{-\textwidth}
%\addtolength\midchapskip{-\oddsidemargin}
%\addtolength\midchapskip{-1in}
%\setlength\beforechapskip{18mm}
%
%\titleformat{\chapter}[display]
%  {\normalfont\filleft}
%{{\chapnamefont\chaptertitlename}%
%\rlap{\hspace{.8em}
%\makebox[\dimexpr\paperwidth-\evensidemargin-\hoffset-1in][r]{{\resizebox{!}{\beforechapskip}{\chapnumfont\thechapter}}\quad%
%\rule{46pt}{\beforechapskip}}%
%}}%
%  {25pt}
%  {\chaptitlefont}
%\titlespacing*{\chapter}
%  {0pt}{40pt}{40pt}


% ******************************** New custom commands **********************************

\newcommand{\comment}[1]
{\par {\bfseries \color{blue} #1 \par}} %comment showed
\newcommandx{\unsure}[2][1=]{\todo[linecolor=red,backgroundcolor=red!25,bordercolor=red,#1]{#2}}
\newcommandx{\change}[2][1=]{\todo[linecolor=blue,backgroundcolor=blue!25,bordercolor=blue,#1]{#2}}
\newcommandx{\info}[2][1=]{\todo[linecolor=OliveGreen,backgroundcolor=OliveGreen!25,bordercolor=OliveGreen,#1]{#2}}
\newcommandx{\improvement}[2][1=]{\todo[linecolor=Plum,backgroundcolor=Plum!25,bordercolor=Plum,#1]{#2}}
\newcommandx{\thiswillnotshow}[2][1=]{\todo[disable,#1]{#2}}

%some shortcuts for variables and symbols
\newcommand*\diff{\mathop{}\!\mathrm{d}}
\newcommand*\Diff[1]{\mathop{}\!\mathrm{d^#1}}
\newcommand*\codiff{\mathop{}\!D}
\newcommand{\Lagr}{\mathcal{L}}
\newcommand{\etmiss}{E_{\textrm{T}}^{\textrm{miss}}}
\newcommand{\met}{E_{\textrm{T}}^{\textrm{miss}}}
\newcommand{\vetmiss}{\boldsymbol{E}_{\textrm{T}}^{\textrm{miss}}}
\newcommand{\ptmiss}{p_{\textrm{T}}^{\textrm{miss}}}
\newcommand{\pt}{p_{\textrm{T}}}
\newcommand{\mbb}{m_{b\bar{b}}}
\newcommand{\ptl}{p^\ell_{\textrm{T}}}
\newcommand{\mt}{m_{\textrm{T}}}
\newcommand{\mct}{m_{\textrm{CT}}}
\newcommand{\mlb}{m_{\ell b_{1}}}
\newcommand{\mjj}{m_{\textrm{jj}}}
\newcommand{\GeV}{\SI{}{\GeV}}
\newcommand{\vptlep}{\boldsymbol{p}_{\textrm{T}}^\ell}
\newcommand{\lsp}{\tilde{\chi}_1^0}
\newcommand{\charg}{\tilde{\chi}_1^\pm}
\newcommand{\neutr}{\tilde{\chi}_2^0}
\newcommand{\wjets}{W+\mathrm{jets}}
\newcommand{\ttbar}{t\bar{t}}


\newcommand{\onelepton}{\ensuremath{1\ell}\@\xspace}
\newcommand{\onethirtynineifb}{\ensuremath{\SI{139}{\femto\barn^{-1}}}\@\xspace}
\newcommand{\onefortyifb}{\ensuremath{\SI{140}{\femto\barn^{-1}}}\@\xspace}
\newcommand{\onefiftyifb}{\ensuremath{\SI{150}{\femto\barn^{-1}}}\@\xspace}
\newcommand{\thirtysixifb}{\ensuremath{\SI{36.1}{\femto\barn^{-1}}}\@\xspace}


\newcommand{\Rplus}{\protect\hspace{-.1em}\protect\raisebox{.35ex}{\smaller{\smaller\textbf{+}}}}
\newcommand{\Cpp}{\mbox{C\Rplus\Rplus}\xspace}

\newcommand{\pylib}[1]{\textsc{#1}}
\newcommand{\lib}[1]{\textsc{#1}}

%some shortcuts for common things that I need to write quite often
\newcommand{\citeneed}{\textbf{[CITATION~NEEDED]}}
\usepackage{xspace}
\newcommand*{\eg}{e.g.\@\xspace}
\newcommand*{\ie}{i.e.\@\xspace}

\makeatletter
\newcommand*{\etc}{%
	\@ifnextchar{.}%
	{etc}%
	{etc.\@\xspace}%
}
\makeatother
%these are todo notes
\newcommand\myworries[1]{\textbf{\textcolor{red}{#1}}}

% harmonise the size of single figures
\newcommand{\singlefigsize}{0.6}
\newcommand{\figname}{fig.\@\xspace}
\newcommand{\fignames}{figs.\@\xspace}
\newcommand{\Figname}{Figure}
\newcommand{\Fignames}{Figures}
\newcommand{\reference}{Ref.\@\xspace}
\newcommand{\Reference}{Ref.\@\xspace}
\newcommand{\references}{Refs.\@\xspace}
\newcommand{\References}{Refs.\@\xspace}


% ******************************** Acronyms **********************************


\newacronym{sm}{SM}{Standard Model of particle physics}
\newacronym{ewk}{EWK}{electroweak}
\newacronym{hep}{HEP}{high energy physics}
\newacronym{lo}{LO}{leading order}
\newacronym[plural=HPCs,longplural={high-performance computers}]{hpc}{HPC}{high-performance computer}
\newacronym{nlo}{NLO}{next-to-leading order}
\newacronym{nll}{NLL}{next-to-leading logarithm}
\newacronym{nnlo}{NNLO}{next-to-next-to-leading order}
\newacronym{qed}{QED}{quantum electrodynamics}
\newacronym[plural=QFTs,longplural={quantum field theories}]{qft}{QFT}{quantum field theory}
\newacronym{qcd}{QCD}{quantum chromodynamics}
\newacronym[plural=VEVs,longplural={vacuum expectation values}]{vev}{VEV}{vacuum expectation value}
\newacronym{ckm}{CKM}{Cabibbo--Kobayashi--Maskawa}
\newacronym{pmns}{PMNS}{Pontecorvo--Maki--Nakagawa--Sakata}
\newacronym{susy}{SUSY}{Supersymmetry}
\newacronym{lsp}{LSP}{lightest supersymmetric particle}
\newacronym[plural=WIMPs,longplural={weakly interacting massive particles}]{wimp}{WIMP}{weakly interacting massive particle}
\newacronym{bsm}{BSM}{beyond the Standard Model}
\newacronym{cmb}{CMB}{cosmic microwave background}
\newacronym{dm}{DM}{dark matter}
\newacronym{gut}{GUT}{grand unified theory}
\newacronym{mssm}{MSSM}{Minimal Supersymmetric Standard Model}
\newacronym{pmssm}{pMSSM}{phenomenological Minimal Supersymmetric Standard Model}
\newacronym{lcdm}{$\Lambda$CDM}{Lambda Cold Dark Matter}
\newacronym{em}{EM}{Electromagnetic}
\newacronym{emec}{EMEC}{electromagnetic end-cap calorimeter}
\newacronym{hec}{HEC}{hadronic end-cap calorimeter}
\newacronym{lhc}{LHC}{Large Hadron Collider}
\newacronym{hl-lhc}{HL-LHC}{High Luminosity LHC}
\newacronym{lep}{LEP}{Large Electron Positron}
\newacronym[plural=FCNCs,longplural={flavour-changing neutral currents}]{fcnc}{FCNC}{flavour-changing neutral current}
\newacronym{rf}{RF}{radio frequency}
\newacronym{vdm}{vdM}{van der Meer}
%\newacronym{ps}{PS}{Proton Synchrotron}
%\newacronym{sps}{SPS}{Super Proton Synchrotron}
\newacronym{id}{ID}{inner detector}
\newacronym{ip}{IP}{interaction point}
\newacronym{sct}{SCT}{silicon microstip tracker}
\newacronym{trt}{TRT}{transition radiation tracker}
\newacronym{ibl}{IBL}{insertable B-layer}
\newacronym{ecal}{ECal}{electromagnetic calorimeter}
\newacronym{fcal}{FCal}{forward calorimeter}
\newacronym{hcal}{HCal}{hadronic calorimeter}
\newacronym{lar}{LAr}{liquid argon}
\newacronym{ms}{MS}{muon spectrometer}
\newacronym[plural=MDTs,longplural={Monitored Drift Tubes}]{mdt}{MDT}{Monitored Drift Tube}
\newacronym[plural=CSCs,longplural={Cathode Strip Chambers}]{csc}{CSC}{Cathode Strip Chamber}
\newacronym[plural=RPCs,longplural={Resistive Plate Chambers}]{rpc}{RPC}{Resistive Plate Chamber}
\newacronym[plural=TGCs,longplural={Thin Gap Chambers}]{tgc}{TGC}{Thin Gap Chamber}
\newacronym{zdc}{ZDC}{Zero-Degree Calorimeter}
\newacronym{alfa}{ALFA}{Absolute Luminosity for ATLAS}
\newacronym{afp}{AFP}{ATLAS Forward Proton}
\newacronym{l1}{L1}{Level~1}
\newacronym{l1topo}{L1Topo}{Level-1 Topological Processor}
\newacronym{hlt}{HLT}{High Level Trigger}
\newacronym{daq}{DAQ}{Data Acquisition System}
\newacronym[plural=ROIs,longplural={regions of interest}]{roi}{ROI}{region of interest}
\newacronym{mc}{MC}{Monte Carlo}
\newacronym{me}{ME}{matrix element}
\newacronym{ps}{PS}{parton shower}
\newacronym{isr}{ISR}{initial state radiation}
\newacronym{fsr}{FSR}{final state radiation}
\newacronym[plural=pdfs,longplural={probability density functions}]{pdf}{pdf}{probability density function}
\newacronym[plural=PDFs,longplural={parton distribution functions}]{PDF}{PDF}{parton distribution function}
\newacronym{poi}{POI}{Parameter of Interest}
\newacronym{mle}{MLE}{maximum likelihood estimator}
\newacronym{cmle}{CMLE}{conditional maximum likelihood estimator}
\newacronym{hf}{HF}{heavy flavour}
\newacronym{vbf}{VBF}{vector boson fusion}
\newacronym{ggf}{ggF}{gluon--gluon fusion}
\newacronym{jes}{JES}{jet energy scale}
\newacronym{jer}{JER}{jet energy resolution}
\newacronym{jvt}{JVT}{jet vertex tagger}
\newacronym{gsc}{GSC}{global sequential calibration}
\newacronym{bdt}{BDT}{boosted decision tree}
\newacronym{dr}{DR}{diagram removal}
\newacronym{ds}{DS}{diagram subtraction}
\newacronym{cp}{CP}{combined performance}
\newacronym{roc}{ROC}{receiver operating characteristic}
\newacronym[plural=SRs,longplural={signal regions}]{sr}{SR}{signal region}
\newacronym[plural=CRs,longplural={control regions}]{cr}{CR}{control region}
\newacronym[plural=VRs,longplural={validation regions}]{vr}{VR}{validation region}
